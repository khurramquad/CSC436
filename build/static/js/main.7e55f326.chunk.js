(this.webpackJsonpinclassdemo=this.webpackJsonpinclassdemo||[]).push([[0],{112:function(e,t,a){"use strict";a.r(t);var c=a(0),r=a.n(c),s=a(27),n=a.n(s),o=a(5),i=a(9),d=a(1);var j=r.a.createContext({primaryColor:"deepskyblue",secondaryColor:"coral"}),u=r.a.createContext({state:{},dispatch:function(){}});function l(){var e=Object(c.useContext)(u),t=e.state,a=e.dispatch,r=t.user;return Object(d.jsxs)("form",{onSubmit:function(e){e.preventDefault(),a({type:"LOGOUT"})},children:["Logged in as: ",Object(d.jsx)("b",{children:r.username}),Object(d.jsx)("input",{type:"submit",value:"Logout"})]})}var b=a(2),O=a(123),h=a(121),x=a(79);function p(e){var t=e.show,a=e.handleClose,r=Object(c.useContext)(u).dispatch,s=Object(c.useState)({username:"",password:"",passwordRepeat:""}),n=Object(o.a)(s,2),j=n[0],l=n[1],p=Object(c.useState)(""),f=Object(o.a)(p,2),m=(f[0],f[1]),g=Object(i.b)((function(e,t){return{url:"auth/register",method:"post",data:{username:e,password:t,passwordConfirmation:t}}})),v=Object(o.a)(g,2),C=v[0],w=v[1];return Object(c.useEffect)((function(){C&&C.data&&r({type:"REGISTER",username:C.data.username})}),[C]),Object(c.useEffect)((function(){C&&!1===C.isLoading&&(C.data||C.error)&&(C.error?(console.log(C),m("Registration failed, please try again later."),alert("fail")):(console.log(C),m("Registration successful. You may now login."),alert("success")))}),[C]),Object(d.jsx)(O.a,{show:t,onHide:a,children:Object(d.jsxs)(h.a,{onSubmit:function(e){e.preventDefault(),w(j.username,j.password),a()},children:[Object(d.jsx)(O.a.Header,{closeButton:!0,children:Object(d.jsx)(O.a.Title,{children:"Register"})}),Object(d.jsxs)(O.a.Body,{children:[Object(d.jsx)(h.a.Label,{htmlFor:"register-username",children:"Username:"}),Object(d.jsx)(h.a.Control,{type:"text",value:j.username,onChange:function(e){return l(Object(b.a)(Object(b.a)({},j),{},{username:e.target.value}))},name:"register-username",id:"register-username"}),Object(d.jsx)(h.a.Label,{htmlFor:"register-password",children:"Password:"}),Object(d.jsx)(h.a.Control,{type:"password",name:"register-password",id:"register-password",value:j.password,onChange:function(e){return l(Object(b.a)(Object(b.a)({},j),{},{password:e.target.value}))}}),Object(d.jsx)(h.a.Label,{htmlFor:"register-password-repeat",children:"Repeat password:"}),Object(d.jsx)(h.a.Control,{type:"password",name:"register-password-repeat",id:"register-password-repeat",value:j.passwordRepeat,onChange:function(e){return l(Object(b.a)(Object(b.a)({},j),{},{passwordRepeat:e.target.value}))}})]}),Object(d.jsxs)(O.a.Footer,{children:[Object(d.jsx)(x.a,{variant:"secondary",onClick:a,children:"Cancel"}),Object(d.jsx)(x.a,{variant:"primary",type:"submit",disabled:0===j.username.length||0===j.password.length||j.password!==j.passwordRepeat,children:"Register"})]})]})})}function f(e){var t=e.show,a=e.handleClose,r=Object(c.useContext)(u).dispatch,s=Object(c.useState)(""),n=Object(o.a)(s,2),j=n[0],l=n[1],b=Object(c.useState)(!1),p=Object(o.a)(b,2),f=p[0],m=p[1],g=Object(c.useState)(""),v=Object(o.a)(g,2),C=v[0],w=v[1];var y=Object(i.b)((function(e,t){return{url:"auth/login",method:"post",data:{username:e,password:t}}})),T=Object(o.a)(y,2),E=T[0],L=T[1];return Object(c.useEffect)((function(){E&&E.data&&(E.data.length>0?(m(!1),r({type:"LOGIN",username:E.data[0].username})):m(!0))}),[E]),Object(c.useEffect)((function(){E&&!1===E.isLoading&&(E.data||E.error)&&(E.error?(m(!0),alert("failed")):(m(!1),console.log(E.data),r({type:"LOGIN",username:j,access_token:E.data.access_token})))}),[E]),Object(d.jsx)(O.a,{show:t,onHide:a,children:Object(d.jsxs)(h.a,{onSubmit:function(e){e.preventDefault(),L(j,C),a()},children:[Object(d.jsx)(O.a.Header,{closeButton:!0,children:Object(d.jsx)(O.a.Title,{children:"Login"})}),Object(d.jsxs)(O.a.Body,{children:[Object(d.jsx)(h.a.Label,{htmlFor:"login-username",children:"Username:"}),Object(d.jsx)(h.a.Control,{type:"text",value:j,onChange:function(e){l(e.target.value)},name:"login-username",id:"login-username"}),Object(d.jsx)(h.a.Label,{htmlFor:"login-password",children:"Password:"}),Object(d.jsx)(h.a.Control,{type:"password",value:C,onChange:function(e){w(e.target.value)},name:"login-password",id:"login-password"}),f&&Object(d.jsx)(h.a.Text,{style:{color:"red"},children:"Invalid username or password"})]}),Object(d.jsxs)(O.a.Footer,{children:[Object(d.jsx)(x.a,{variant:"secondary",onClick:a,children:"Cancel"}),Object(d.jsx)(x.a,{variant:"primary",disabled:0===j.length,type:"submit",children:"Login"})]})]})})}function m(){var e=Object(c.useContext)(u).state,t=Object(c.useState)(!1),a=Object(o.a)(t,2),r=a[0],s=a[1],n=Object(c.useState)(!1),i=Object(o.a)(n,2),j=i[0],b=i[1];return e.user.username?Object(d.jsx)(l,{}):Object(d.jsxs)("div",{className:"justify-content-end",children:[Object(d.jsx)(x.a,{variant:"link",onClick:function(e){return s(!0)},children:"Login"}),Object(d.jsx)(f,{show:r,handleClose:function(){return s(!1)}}),Object(d.jsx)(x.a,{variant:"link",onClick:function(e){return b(!0)},children:"Register"}),Object(d.jsx)(p,{show:j,handleClose:function(){return b(!1)}})]})}var g=a(12);function v(){var e=Object(c.useState)(""),t=Object(o.a)(e,2),a=t[0],r=t[1],s=Object(c.useState)(""),n=Object(o.a)(s,2),j=n[0],l=n[1],b=Object(g.d)(),O=Object(c.useContext)(u),h=O.state,x=O.dispatch,p=h.user,f=Object(i.b)((function(e){var t=e.title,a=e.description,c=e.author;return{url:"/todo",method:"post",headers:{Authorization:"".concat(h.user.access_token)},data:{title:t,description:a,author:c,dateCreated:Date(Date.now())}}})),m=Object(o.a)(f,2),v=m[0],C=m[1];return Object(c.useEffect)((function(){v&&v.data&&(x({type:"CREATE_TODO",title:v.data.title,description:v.data.description,id:v.data.id,author:p.username}),console.log(v.data),b.navigate("/todo/".concat(v.data)))}),[v]),Object(d.jsxs)("form",{onSubmit:function(e){e.preventDefault(),C({title:a,description:j,author:p.username})},children:[Object(d.jsxs)("div",{children:["Author: ",Object(d.jsx)("b",{children:p.username})]}),Object(d.jsxs)("div",{children:[Object(d.jsx)("label",{htmlFor:"create-title",children:"Title:"}),Object(d.jsx)("input",{type:"text",value:a,onChange:function(e){r(e.target.value)},name:"create-title",id:"create-title"})]}),Object(d.jsx)("textarea",{value:j,onChange:function(e){l(e.target.value)}}),Object(d.jsx)("input",{type:"submit",value:"Create"})]})}var C=a(125);function w(e){var t=e.title,a=e.description,r=(e.author,e.short,e.dateCreated),s=e.complete,n=e.completedOn,l=e.todoId,b=Object(c.useContext)(j).secondaryColor,O=Object(c.useContext)(u).dispatch,h=Object(c.useContext)(u).state,p=h.user;console.log("ToDo rendered");var f=a,m=Object(i.b)((function(e){return{url:"/todo/".concat(e),headers:{Authorization:"".concat(h.user.access_token)},method:"delete"}})),v=Object(o.a)(m,2),w=v[0],y=v[1],T=Object(i.b)((function(e,t){return{url:"/todo/update/".concat(e),method:"post",headers:{Authorization:"".concat(h.user.access_token)},data:{complete:t,completedOn:Date.now()}}})),E=Object(o.a)(T,2),L=E[0],k=E[1];return Object(c.useEffect)((function(){w&&w.data&&(console.log("Dispatch"),O({type:"DELETE_TODO",todoId:p.todoId}))}),[w]),Object(c.useEffect)((function(){L&&L.data&&!1===L.isLoading&&O({type:"TOGGLE_TODO",complete:L.data.complete,completedOn:L.data.completedOn,todoId:l})}),[L]),Object(d.jsx)(C.a,{children:Object(d.jsxs)(C.a.Body,{children:[Object(d.jsx)(C.a.Title,{children:Object(d.jsx)(g.a,{style:{color:b},href:"/todo/".concat(l),children:t})}),Object(d.jsx)(C.a.Subtitle,{children:Object(d.jsxs)("i",{children:["Written by ",Object(d.jsx)("b",{children:p.username})]})}),Object(d.jsxs)(C.a.Text,{children:[f,Object(d.jsx)("br",{}),Object(d.jsxs)("i",{children:["Date Created: ",new Date(r).toLocaleDateString("en-us")]}),Object(d.jsx)("br",{})]}),Object(d.jsx)("input",{type:"checkbox",checked:s,onChange:function(e){k(l,e.target.checked)}}),Object(d.jsx)(x.a,{variant:"link",onClick:function(e){y(l),e.preventDefault()},children:"Delete Post"}),s&&Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("br",{}),Object(d.jsxs)("i",{children:["Completed on: ",new Date(n).toLocaleDateString("en-us")]}),Object(d.jsx)("br",{})]}),Object(d.jsx)(g.a,{href:"/todo/".concat(l),children:"View full ToDo"})]})})}var y=r.a.memo(w);function T(){var e=Object(c.useContext)(u).state.todos;return Object(d.jsx)("div",{children:e.map((function(e,t){return Object(c.createElement)(y,Object(b.a)(Object(b.a)({},e),{},{short:!0,title:e.title,author:e.author,key:"todo-"+t,todoId:e._id,dateCreated:e.dateCreated}))}))})}var E=a(33);function L(e,t){switch(t.type){case"LOGIN":case"REGISTER":return{username:t.username,access_token:t.access_token};case"LOGOUT":return{username:void 0,access_token:void 0};case"FETCH_USERS":return t.users;default:return e}}function k(e,t){switch(t.type){case"CREATE_TODO":return console.log("create_todo"),[{id:t.id,title:t.title,description:t.description,author:t.author,dateCreated:t.dateCreated,complete:!1,completedOn:void 0}].concat(Object(E.a)(e));case"TOGGLE_TODO":return e.map((function(e){return e.id===t.id&&(e.complete=t.complete,e.completedOn=t.completedOn),e}));case"DELETE_TODO":return e.filter((function(e){return e.id!==t.todoId}));case"FETCH_TODOS":return console.log(t.todos),t.todos;default:return e}}function D(e,t){return{user:L(e.user,t),todos:k(e.todos,t)}}var S=a(122),_=function(e){var t=e.text,a=Object(c.useContext)(j);return Object(d.jsx)(g.a,{href:"/",children:Object(d.jsx)(S.a.Brand,{style:{color:a.primaryColor},children:t})})};a(120);var R=a(124),I=a(119);function F(e){e.setTheme,Object(c.useContext)(j);var t=Object(c.useContext)(u).state.user;return Object(d.jsx)(S.a,{bg:"light",expand:"lg",children:Object(d.jsxs)(I.a,{children:[Object(d.jsx)(S.a.Brand,{href:"/",children:Object(d.jsx)(_,{text:"My ToDo"})}),Object(d.jsx)(S.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(d.jsxs)(S.a.Collapse,{id:"basic-navbar-nav",children:[Object(d.jsxs)(R.a,{className:"me-auto",children:[t.username&&Object(d.jsx)(R.a.Link,{children:Object(d.jsx)(g.a,{href:"/todo/create",children:"Create New ToDo"})}),t.username&&Object(d.jsx)(R.a.Link,{children:Object(d.jsx)(g.a,{href:"/users",children:"Users Page"})})]}),Object(d.jsx)(r.a.Suspense,{fallback:"Loading...",children:Object(d.jsx)(m,{})})]})]})})}function G(){var e=Object(c.useContext)(u),t=e.state,a=e.dispatch,r=Object(i.b)((function(){return{url:"/todo",headers:{Authorization:"".concat(t.user.access_token)},method:"get"}})),s=Object(o.a)(r,2),n=s[0],j=s[1];Object(c.useEffect)((function(){j()}),[t.user.access_token]),Object(c.useEffect)((function(){n&&!1===n.isLoading&&n.data&&(console.log(n.data),a({type:"FETCH_TODOS",todos:n.data.todos}))}),[n]);n.data;var l=n.isLoading;return Object(d.jsxs)(d.Fragment,{children:[l&&"Loading ToDos..."," ",Object(d.jsx)(T,{})]})}var U=a(11);function A(e){var t=e.todoId,a=Object(c.useContext)(u).state,r=Object(i.b)((function(){return{url:"/todo/".concat(t),headers:{Authorization:"".concat(a.user.access_token)},method:"get"}})),s=Object(o.a)(r,2),n=s[0],j=s[1];return Object(c.useEffect)(j,[t]),Object(d.jsxs)("div",{children:[n&&n.data?Object(d.jsx)(y,Object(b.a)({},n.data)):"Loading...",Object(d.jsx)("div",{children:Object(d.jsx)(g.a,{href:"/",children:"Go back"})})]})}a(111);function B(e){e.username;var t=e.userId,a=Object(c.useContext)(j).secondaryColor,r=(Object(c.useContext)(u).dispatch,Object(c.useContext)(u).state.user);return Object(d.jsx)(C.a,{children:Object(d.jsxs)(C.a.Body,{children:[Object(d.jsx)(C.a.Title,{children:Object(d.jsx)(g.a,{style:{color:a},href:"/users/".concat(t),children:r.username})}),Object(d.jsx)(C.a.Subtitle,{children:Object(d.jsxs)("i",{children:["User ID: ",Object(d.jsx)("b",{children:r.userId})]})}),Object(d.jsx)(g.a,{href:"/users/".concat(t),children:"View full User ToDo"})]})})}var H=r.a.memo(B);function z(){var e=Object(c.useContext)(u).state.users;return Object(d.jsx)("div",{children:e.map((function(e,t){return Object(c.createElement)(H,Object(b.a)(Object(b.a)({},e),{},{username:e.username,key:"user-"+t,userId:e.id,password:e.password}))}))})}function N(){var e=Object(c.useContext)(u),t=e.state,a=e.dispatch,r=Object(i.b)((function(){return{url:"/user",headers:{Authorization:"".concat(t.user.access_token)},method:"get"}})),s=Object(o.a)(r,2),n=s[0],j=s[1];Object(c.useEffect)((function(){j()}),[t.user.access_token]),Object(c.useEffect)((function(){n&&!1===n.isLoading&&n.data&&(console.log(n.data),a({type:"FETCH_USERS",Users:n.data.users}))}),[n]);n.data;var l=n.isLoading;return Object(d.jsxs)(d.Fragment,{children:[l&&"Loading Users..."," ",Object(d.jsx)(z,{})]})}var P=function(){var e=Object(c.useReducer)(D,{user:{},todos:[]}),t=Object(o.a)(e,2),a=t[0],r=t[1],s=Object(c.useState)({primaryColor:"deepskyblue",secondaryColor:"coral"}),n=Object(o.a)(s,2),i=n[0],l=n[1],b=Object(U.f)({"/":Object(U.g)({view:Object(d.jsx)(G,{})}),"todo/create":Object(U.g)({view:Object(d.jsx)(v,{})}),"/todo/:id":Object(U.g)((function(e){return{view:Object(d.jsx)(A,{id:e.params.id})}})),"/users":Object(U.g)({view:Object(d.jsx)(N,{})}),"/users/:id":Object(U.g)((function(e){return{view:Object(d.jsx)(N,{id:e.params.id})}}))});return a.user,Object(d.jsx)("div",{children:Object(d.jsx)(j.Provider,{value:i,children:Object(d.jsx)(u.Provider,{value:{state:a,dispatch:r},children:Object(d.jsx)(g.b,{routes:b,children:Object(d.jsxs)(I.a,{children:[Object(d.jsx)(F,{setTheme:l}),Object(d.jsx)("hr",{}),Object(d.jsx)(g.c,{})]})})})})})},J=a(46),M=a.n(J).a.create({baseURL:"/"});n.a.render(Object(d.jsx)(r.a.StrictMode,{children:Object(d.jsx)(i.a,{value:M,children:Object(d.jsx)(P,{})})}),document.getElementById("root"))}},[[112,1,2]]]);
//# sourceMappingURL=main.7e55f326.chunk.js.map